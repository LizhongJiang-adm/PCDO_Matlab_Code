
# Source Code for: A Novel Method for Path-Constrained Dynamic Optimization via Integral Transcription and Inner Approximation

This repository contains the MATLAB implementation for the numerical examples presented in the paper. The code is organized into two main parts corresponding to **Section 5.1** (Single Constraint) and **Section 5.2** (Multiple Constraints).

---

## üìÇ Part 1: Single Path Constraint Examples (Section 5.1)

This directory contains the implementation for **Examples 1, 2, and 3**. These examples involve optimal control problems with a single path constraint, comparing the proposed method against several benchmark algorithms.

### 1. Directory Structure

*   **`Proposed_Method/`**: Implementation of the algorithm proposed in this paper (Algorithm 1).
*   **`Comparison_Methods/`**: Implementation of benchmark algorithms for comparison:
    *   `AlphaBB/`, `Interval/`, `Polynomial/`, `Conventional_Discretization/`
*   **`Constraint_Approximation_Comparison/`**: Scripts to reproduce **Figure 7**.

### 2. Prerequisites

*   **MATLAB**: R2024a or later is recommended.
*   **Toolboxes**: Optimization Toolbox (required for `fmincon`).

### 3. How to Run the Examples

#### Mapping of Examples
The code filenames correspond to the paper's examples as follows:

| Paper Section | Code Acronym |
| :--- | :--- |
| **Example 1** | **VDPO** (Van der Pol Oscillator) |
| **Example 2** | **JCB** |
| **Example 3** | **PFBF** (Penicillin Fed-Batch Fermentation) |

#### Execution Modes (Important!)
Each run script (e.g., `run_Ex1_VDPO_Proposed.m`) supports two execution modes, configured at the top of the file:

```matlab
%% --- 1. Configuration ---
ExecutionMode = 'Solve';      % Options: 'Solve', 'Benchmark'
% ExecutionMode = 'Benchmark';
```

*   **`'Solve'` (Default)**: Solves the optimization problem **once**, prints the result, and generates visualization plots.
*   **`'Benchmark'`**: Runs the optimization using MATLAB's `timeit` function to measure accurate CPU time. Use this mode to reproduce the computational performance reported in **Table 1**.
    *   *Note: The `.mat` result files included in the folders contain data from the Benchmark mode.*

#### Running the Code
1.  Navigate to the desired method folder (e.g., `Proposed_Method/`).
2.  Run the corresponding script (e.g., `run_Ex1_VDPO_Proposed.m`).

### 4. Reproducing Figure 7 

To generate **Figure 7**, navigate to the `Constraint_Approximation_Comparison` folder and run:
```matlab
main_plot_constraint_approximations.m
```

---

## üìÇ Part 2: Multiple Constraints Example (Section 5.2)

This directory contains the implementation for **Example 4** (Kinematic Car / Parking Problem), which features multiple path constraints. This implementation relies on the **CasADi** framework for automatic differentiation.

### 1. Directory Structure

*   **`run_Parking_Proposed.m`**: The main entry point script to run the example.
*   **`solve_with_UB_CasADi.m`**: The core solver interface linking MATLAB's `fmincon` with CasADi symbolics.

### 2. ‚ö†Ô∏è Critical Prerequisites: CasADi

Unlike the single-constraint examples, this specific example **requires CasADi**. Get the MATLAB binaries from the official website: [https://web.casadi.org/get/](https://web.casadi.org/get/)


### 3. How to Run
1.  Ensure CasADi is added to your path.
2.  Open and run `run_Parking_Proposed.m`.
    *   *Like the previous examples, you can switch between `'Solve'` and `'Benchmark'` modes inside the script.*


---

## üìÇ Part 3: Supplementary Tests

This directory contains additional test cases developed to address specific questions raised during the peer review process.

### Oscillatory Constraint Demo (`Example3_Coarse_Initialization_Demo`)

This specific demo was created to verify the algorithm's robustness when handling oscillatory path constraints.

This script forces the proposed algorithm for Example 3 to start with the **coarsest possible partition**: a single time interval covering the entire horizon ($\Pi^0 = \{\Gamma\}$).

#### How to Run
1.  Navigate to the `Example3_Coarse_Initialization_Demo` folder.
2.  Run the script:
    ```matlab
    run_Ex3_Oscillatory_Demo.m
    ```


### Mismatch in Dimensions: A Case with More Constraints than Decision Variables (`PFBF_problem_2PathConstraints`)

‚ö†Ô∏è This implementation also relies on **CasADi**.

This problem is solved by the proposed method using a piecewise-constant control vector parameterization (CVP) with 75 equal-width intervals. The initial time subintervals for both path constraints are set to coincide with these control discretization intervals.
Therefore, this example shows the case that the number of decision variables (75) not matching the total number of constraints generated by the two path constraints (150). 


#### How to Run
1.  Navigate to the `03_Supplementary_Tests/PFBF_problem_2PathConstraints` directory.
2.  Open and run the script:
    ```matlab
    run_PFBF_2constr_Proposed.m
    ```
3.  A detailed mathematical formulation for this specific problem is available in the PDF file `PFBF_problem_2PathConstraints.pdf` within the same directory.